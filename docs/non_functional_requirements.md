# 非機能要件

## ファイル管理

- **許可するファイル形式:** PDF, JPEG, PNG
- **最大ファイルサイズ:** 10MB / 1 ファイルあたり

## セキュリティ

- **パスワードポリシー:**
  - 8 文字以上
  - 英大文字、英小文字、数字をそれぞれ 1 文字以上含む

## エラーハンドリングとデータ整合性

### ネットワークエラーとリトライ

- **方針:** データ取得ライブラリ SWR の自動再試行（リトライ）機能を活用する。
- **設定:**
  - `shouldRetryOnError`: true (ネットワークエラー発生時に自動で再試行)
  - `errorRetryCount`: 3 (最大 3 回まで再試行)
  - `errorRetryInterval`: 2000 (2 秒間隔で再試行)

### データ競合の解決（同時編集対策）

- **方針:** **楽観的ロック**を採用し、データの意図しない上書きを防ぐ。
- **実装方法:**
  1. 主要なテーブル（`students`, `schedules`など）には`updated_at`タイムスタンプを必ず含める。
  2. ユーザーが編集画面を開いた際に、現在の`updated_at`の値も一緒に取得する。
  3. ユーザーが「更新」ボタンを押した際、API はフロントエンドから送られてきた`updated_at`の値と、データベース上の現在の`updated_at`の値を比較する。
  4. 値が一致すれば、更新を実行する。
  5. 値が一致しない（＝他の誰かが先に更新した）場合、HTTP ステータスコード `409 Conflict` を返し、フロントエンドに「このデータは他のユーザーによって更新されました。ページをリロードしてください」といったエラーメッセージを表示する。

### サーバーエラー (5xx 系)

- 予期せぬサーバーエラーが発生した場合、専用のエラーページに遷移させ、「現在サーバーでエラーが発生しています。時間をおいて再度お試しください」といったメッセージを表示する。

### 入力エラー (4xx 系)

- フォームの入力値がバリデーションルールに違反した場合、対象の入力欄の下に具体的なエラー内容（例：「8 文字以上で入力してください」）を表示する。処理は中断する。
