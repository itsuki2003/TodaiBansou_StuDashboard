# 4-3. 個人ダッシュボード画面（成績情報タブ）

## 1. UI/UX 設計（ワイヤーフレーム）

### 「成績情報」タブの表示内容

- **成績一覧:**
  - これまでに登録された全模試の結果を、受験日順にアコーディオン形式で表示する。
  - 各アコーディオンのヘッダーには「受験日」「模試名」を表示する。
- **成績詳細:**
  - アコーディオンを開くと、科目ごとの詳細な成績（点数、偏差値など）がテーブルで表示される。
  - ヘッダー部分に「編集」「削除」ボタンを配置する。
  - 「編集」を押すと登録モーダルが開き、既存データが読み込まれた状態で表示される。
- **操作ボタン:**
  - ページ上部に「新しい成績を登録」ボタンを配置する。

### 成績登録・編集モーダル

- **入力項目:**
  - **受験日:** 日付ピッカー
  - **模試の種類:** `exam_types`テーブルから取得した模試名のドロップダウンリスト
  - **科目別成績:**
    - 科目、点数、偏差値を入力する行を動的に追加・削除できるテーブル形式の入力欄。
- **編集時の挙動:**
  - 「編集」ボタンからモーダルを開いた場合は、`grades`および`grade_details`から既存データを取得して各入力欄に表示する。

## 2. DB 設計

- **関連テーブル:** `grades`, `grade_details`, `exam_types`
- **データフロー:**
  - 成績を登録すると、まず`grades`テーブルにヘッダ情報（生徒 ID, 模試 ID, 受験日）が保存される。
  - 次に、科目ごとの成績が`grade_details`テーブルに複数行として保存される。

## 3. 詳細機能仕様

- **データ表示:**
  - タブを開くと、`grades`テーブルを親として`grade_details`テーブルを JOIN し、全成績データを取得して表示する。
- **成績の登録:**
  - 「新しい成績を登録」モーダルで、まだリストにない模試名を登録する必要がある場合、ドロップダウンに「新しい模試を追加」オプションを用意し、その場で`exam_types`マスタに新しい模試を追加できる機能も設ける。
  - 「新しい模試を追加」を選択するとモーダル内に模試名入力フィールドが表示され、入力後に`exam_types`テーブルへ挿入される。登録後はドロップダウンに反映され自動選択される。
- **成績の編集:**
  - 各成績の「編集」ボタンを押すとモーダルが既存データを読み込んで開き、変更内容は`grades`および`grade_details`に更新される。
- **成績の削除:**
  - 「削除」ボタンを押すと確認ダイアログを表示し、承認後に該当する`grades`および`grade_details`のレコードを同時に削除する。
- **操作権限:**
  - 成績の登録・編集・削除は管理者と担当講師のみが行える。
