# 4-1. 個人ダッシュボード画面（基本情報タブ）

## 1. UI/UX 設計（ワイヤーフレーム）

この画面は、タブ切り替え形式のインターフェースを採用する。

### 共通コンポーネント

- **ヘッダーエリア:**
  - 生徒の氏名を常に表示する。
- **タブナビゲーション:**
  - 「基本情報」「スケジュール」「成績情報」「学習状況」「やることリスト」のタブを配置する。
  - デフォルトでは「基本情報」が選択された状態。

### 「基本情報」タブの表示内容

このタブでは生徒および保護者の基本情報を閲覧する。管理者と担当講師のみが画面右上の「基本情報を編集」ボタンから内容を変更でき、その他のユーザーは閲覧のみ。

- **生徒情報:**
  - 生徒の姓・名、カナ姓・カナ名、誕生日、学年
- **保護者情報:**
  - 保護者の姓・名、カナ姓・カナ名、続柄
  - 複数名いる場合は「保護者1」「保護者2」のように番号付きでカード表示する。
- **連絡先情報:**
  - 生徒および保護者ごとに電話番号やメールアドレスを表示
  - `contact_type`はラベル（例: `[電話]`, `[メール]`）として値の前に付与し、複数ある場合は改行して列挙する。
- **志望校:**
  - 第一志望〜第三志望
- **学習環境:**
  - 通塾先（塾・校舎）
  - 習い事

### 基本情報編集モーダルと運用ルール

- 「基本情報を編集」ボタンを押すとモーダルが開き、生徒情報・保護者情報・連絡先情報を一括で登録／更新できる。
- モーダルでは保護者や連絡先の追加・削除が可能で、連絡先登録時には`contact_type`をドロップダウンから選択する。
- 少なくとも 1 件の連絡先には`is_primary`を設定し、主連絡先は保存後に一覧上で最上位に表示する。
- 「保存」で各テーブル（`students`,`guardians`,`contacts`）を更新し、「キャンセル」で破棄する。編集権限のないユーザーにはボタンを表示しない。

## 2. DB 設計

- **関連テーブル:** `students`, `guardians`, `contacts`
- **表示データ:**
  - `students`テーブルから基本情報を取得。
  - `students.id`に紐づく`guardians`テーブルから保護者情報を取得。
  - `students.id`および`guardians.id`に紐づく`contacts`テーブルから連絡先情報を取得する。

## 3. 詳細機能仕様

- **アクセス権限:**
  - **管理者:** 全生徒のダッシュボードを閲覧・編集可能。
  - **講師:** 自分が担当する生徒のダッシュボードのみ閲覧・編集可能。
- **データ表示:**
  - URL（例: `/students/{student_id}`）に含まれる生徒 ID を元に、関連テーブルを JOIN して必要な情報を全て取得し、表示する。
- **データ取得方法:**
  - フロントエンドから Next.js の API Route を経由して Supabase からデータを取得し、直接クライアントから Supabase を操作しない。

