# 6-2. データエクスポート機能

- **アクセス権限:** Admin, SystemAdmin
- **配置場所:** 生徒一覧画面

## 1. UI/UX 設計

- **エクスポートボタン:**
  - 生徒一覧画面のテーブルの上部（「新規ユーザー追加」ボタンの隣など）に、「CSV エクスポート」ボタンを配置する。

## 2. 機能仕様

- **エクスポート対象データ:**

  - **生徒情報:** `students`テーブル
  - **保護者情報:** `guardians`テーブル
  - **連絡先情報:** `contacts`テーブル
  - **成績情報:** `grades`, `grade_details`, `past_exam_results`テーブル
  - _（その他、必要に応じてエクスポート対象とするテーブルを追加）_

- **実行フロー:**

  1. 管理者が「CSV エクスポート」ボタンをクリックする。
  2. 現在、生徒一覧画面で**絞り込まれている条件を考慮**し、対象となる生徒の関連データをデータベースから全て取得する。
     - 例：「6 年生」で絞り込まれている場合、6 年生の生徒データのみがエクスポート対象となる。
  3. 取得したデータを CSV 形式のファイルとして生成する。関連テーブルのデータは適切に結合し、1 行に 1 生徒の情報がまとまるように整形する。
  4. 生成された CSV ファイルが、ユーザーのブラウザを通じてダウンロードされる。

  - ファイル名は `students_export_YYYY-MM-DD.csv` のような形式とする。

- **実装方法:**
  - クライアントサイドの JavaScript ライブラリ（例: `xlsx` や `papaparse`）を使用して CSV を生成する。これにより、サーバーへの負荷をかけずにエクスポート機能を実現できる。
